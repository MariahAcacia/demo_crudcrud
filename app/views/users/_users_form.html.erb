<h1>
  <%= user.persisted? ? "Update" : "New" %> User Form: Nested
</h1>

<%= form_for user do |user_fields| %>
  
  <%= user_fields.label :name %>
  <%= user_fields.text_field :name %>
  
  <br>

  <%= user_fields.label :email %>
  <%= user_fields.text_field :email %>


  <br>

  <% if false %>
    <h2>Addresses Fields using Iteration</h2>
    <% user.addresses.each_with_index do |address, i| %>
      <%= fields_for "addresses[]", address do |address_fields| %>
        <h2> 
          New/Edit ITERATED Address(es):
        </h2>
        <%= address_fields.label :street_address %>
        <%= address_fields.text_field :street_address %>
        <br>
        <%= address_fields.label :city %>
        <%= address_fields.text_field :city %>
        <br>
        <%= address_fields.label :state %>
        <%= address_fields.text_field :state %>
        <br>
        <%= address_fields.label :zip %>
        <%= address_fields.text_field :zip %>
        <br>
      <% end %>
    <% end %>
  <% end %>

  <br><br>

  <% if true %>
    <h2>User Addresses</h2>
    <%= user_fields.fields_for :addresses do |address_fields| %>
      <h3> 
        <%= address_fields.object.persisted? ? "Edit" : "New" %> Address:
      </h3>
      <%= address_fields.label :street_address %>
      <%= address_fields.text_field :street_address %>
      <br>
      <%= address_fields.label :city %>
      <%= address_fields.text_field :city %>
      <br>
      <%= address_fields.label :state %>
      <%= address_fields.text_field :state %>
      <br>
      <%= address_fields.label :zip %>
      <%= address_fields.text_field :zip %>
      <br>
    <% end %>
  <% end %>
  
  <%= user_fields.submit %>
<% end %>